<!DOCTYPE html>
<html lang="en">

i<head>
	<!-- Global site tag (gtag.js) - Google Analytics -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=UA-146581885-1"></script>
	<script>
		window.dataLayer = window.dataLayer || [];

		function gtag() {
			dataLayer.push(arguments);
		}
		gtag('js', new Date());

		gtag('config', 'UA-146581885-1');
	</script>
	<title>Extracting Data from JSON with Ruby | Eric Chrobak</title>
	<meta charset="utf-8">
	<meta name="author" content="Eric Chrobak">
	<meta name="google-site-verification" content="mlSH_0PUjKe4Vjt1l5LJBdkVBq2rtdxkN0A2gV92NU4" />
	<meta name="description" content="Eric Chrobak is a software engineer. Skills include Ruby, Rails, HTML, CSS, and JavaScript.">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<!--Fonts-->
	<link href='https://fonts.googleapis.com/css?family=Inconsolata' rel='stylesheet' type='text/css'>
	<link href='https://fonts.googleapis.com/css?family=Pacifico' rel='stylesheet' type='text/css'>
	<!--CSS-->
	<link rel="shortcut icon" type="image/icon" href="/jpg/webfavicon.png">
	<link rel="icon" type="image/icon" href="/jpg/webfavicon.png">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
	<link rel="stylesheet" href="/css/scrolling-nav.css">
	<!-- custom style -->
	<link rel="stylesheet" href="/css/style.css">
	<link rel="stylesheet" type="text/css" href="/css/responsive.css">
	<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.30.0/themes/prism.min.css" rel="stylesheet" />
	<style type="text/css"></style>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
	<script src="/javascript/jquery.easing.min.js"></script>
	<script src="/javascript/scroll-down.js"></script>
	<script src="/javascript/script.js"></script>
	<script src="/javascript/scrolling-nav.js"></script>
</head>


<body id="page-top" data-spy="scroll" data-target=".navbar-fixed-top">

    <!-- Navigation -->
<nav class="navbar navbar-default navbar-fixed-top smart-scroll" role="navigation">
    <div class="container-fluid">

        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false" aria-controls="bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand page-scroll" id="name" href="#page-top">EC</a>
        </div>


        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a class="page-scroll active" href="http://localhost:4000/">Home</a>
                </li>
                
                <li>
                    <a class="page-scroll" href="http://localhost:4000/about.html">About</a>
                </li>
                
                <li>
                    <a class="page-scroll" href="http://localhost:4000/blog.html">Blog</a>
                </li>
                

            </ul>
        </div>

    </div>
</nav>


	<div class="post">
    <div class="container-fluid">
        <h1>Extracting Data from JSON with Ruby</h1>
        <p id="date">13 Sep 2023 - Eric Chrobak</p>
        <p><br />
I have a simple app I built to receive a string and pass that string to a .txt file. The next goal of the application was to receive data from a .json file. The main hurdles that I had to face were setting headers and formatting the data to output to a file. That required a complete overhaul of the app. The initial application was a class with an initialize function, set headers, set content, create file, and write to file function.
<br /></p>

<h2 id="changing-the-initialization-function"><strong>Changing the Initialization function</strong></h2>
<p>The first version of the initialization took the file input and set it to a attr_accessor variable and set the output as a string. 
<br /></p>
<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">file_input</span><span class="p">)</span>
  <span class="nb">self</span><span class="p">.</span><span class="nf">file_input</span> <span class="o">=</span> <span class="n">file_input</span>
  <span class="nb">self</span><span class="p">.</span><span class="nf">file_output</span> <span class="o">=</span> <span class="s2">""</span>
<span class="k">end</span>
</code></pre></div></div>
<p><br />
The initial code to run the class passed the file name and content via a different method. 
<br /></p>
<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">file_obj</span> <span class="o">=</span> <span class="no">CreateUpdateFile</span><span class="p">.</span><span class="nf">new</span><span class="p">()</span>
<span class="n">file_obj</span><span class="p">.</span><span class="nf">create_file</span><span class="p">(</span><span class="s2">"content.txt"</span><span class="p">,</span><span class="n">headers</span><span class="p">,</span><span class="n">content</span><span class="p">)</span>
</code></pre></div></div>
<p><br />
It was redunant to instantiate the object and then call another function to pass the content and file name. 
<br /></p>
<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="nb">name</span><span class="p">,</span><span class="n">input</span><span class="p">)</span>
  <span class="nb">self</span><span class="p">.</span><span class="nf">input</span><span class="p">(</span><span class="n">input</span><span class="p">)</span> 
  <span class="nb">self</span><span class="p">.</span><span class="nf">output</span> <span class="o">=</span> <span class="vi">@headers</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span> <span class="o">+</span> <span class="vi">@content</span>
  <span class="nb">self</span><span class="p">.</span><span class="nf">write_to_file</span><span class="p">(</span><span class="nb">name</span><span class="p">)</span>
<span class="k">end</span>
</code></pre></div></div>

<h1 id="setting-the-headers"><strong>Setting the Headers</strong></h1>
<p>In the previous version of the application I was receiving the headers as an array. This would happen when invoking the create file function. The headers were passed as an argument to the function. Then another function was called to set the headers. This was setting the array indexes as a pipe delimited string.
<br /></p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">set_headers</span><span class="p">(</span><span class="n">headers</span><span class="p">)</span>
  <span class="n">header_length</span> <span class="o">=</span> <span class="n">headers</span><span class="p">.</span><span class="nf">length</span>
  <span class="n">iteration</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="n">headers</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">i</span><span class="o">|</span>
    <span class="n">iteration</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">header_length</span> <span class="o">!=</span> <span class="n">iteration</span>
      <span class="vi">@file_output</span> <span class="o">&lt;&lt;</span> <span class="s2">"</span><span class="si">#{</span><span class="n">i</span><span class="si">}</span><span class="s2"> | "</span>
    <span class="k">else</span>
      <span class="vi">@file_output</span> <span class="o">&lt;&lt;</span> <span class="s2">"</span><span class="si">#{</span><span class="n">i</span><span class="si">}</span><span class="s2">"</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>
<p><br />
In the new initialize method another class method is called to set the content and headers. The content and headers are passed in as an array of hashes. The key is the header and the value is the content for the file output.
<br /></p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="nb">name</span><span class="p">,</span><span class="n">input</span><span class="p">)</span>
  <span class="nb">self</span><span class="p">.</span><span class="nf">input</span><span class="p">(</span><span class="n">input</span><span class="p">)</span> 
  <span class="nb">self</span><span class="p">.</span><span class="nf">output</span> <span class="o">=</span> <span class="vi">@headers</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span> <span class="o">+</span> <span class="vi">@content</span>
  <span class="nb">self</span><span class="p">.</span><span class="nf">write_to_file</span><span class="p">(</span><span class="nb">name</span><span class="p">)</span>
<span class="k">end</span>

<span class="k">def</span> <span class="nf">input</span><span class="p">(</span><span class="n">input</span><span class="p">)</span>
  <span class="n">content</span> <span class="o">=</span> <span class="no">JSON</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="n">input</span><span class="p">)</span>
  <span class="vi">@content</span> <span class="o">=</span> <span class="nb">self</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="n">content</span><span class="p">.</span><span class="nf">values</span><span class="p">)</span>
  <span class="vi">@headers</span> <span class="o">=</span> <span class="nb">self</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="n">content</span><span class="p">.</span><span class="nf">keys</span><span class="p">)</span>
<span class="k">end</span>
</code></pre></div></div>
<p><br />
The new() method calls the input method. The input method receives the input and then extracts the keys and values of the hash. An internal class method is called to format the data in each. It sets them into an array.
<br /><br /></p>

<h2 id="writing-to-the-file"><strong>Writing to the File</strong></h2>
<p>Initially there was a method called update file. However, each method had File.Write. It made more sense to make that line into it’s own method. It served one purpose very well. 
<br /></p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">write_to_file</span><span class="p">(</span><span class="nb">name</span><span class="p">)</span>
  <span class="no">File</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="nb">name</span><span class="p">,</span> <span class="vi">@output</span><span class="p">,</span> <span class="ss">mode: </span><span class="s2">"a"</span><span class="p">)</span>
<span class="k">end</span>
</code></pre></div></div>
<p><br /></p>

<p>Then remaining piece was updating an existing file. Here the input was received, written to an array, and the array pushed to the file.
<br /></p>

<h1 id="final-thoughts"><strong>Final Thoughts</strong></h1>
<p>Before this work was done the app was not replicable. The code base only supported major changes to the code to work in different use cases. Now the application is more durable, flexible, etc
<br /><br /></p>

<h1 id="whats-next"><strong>What’s Next</strong></h1>
<p>This app needs to be able to receive different file or formats for import. The common ones would be .csv, .xlsx, or a JSON that is less formatted.
<br /><br /></p>

<h1 id="our-next-topic"><strong>Our Next Topic</strong></h1>
<p>Adding error handling to the PHP application and launching the application.</p>

    </div>
</div>


    <footer class="footer">
    <div class="container">
        <div class="row">
            <ul>
                <li>
                    <a href="mailto:eric.chrobak@gmail.com">
                        <i class="fa fa-envelope"></i>
                    </a>
                </li>
                <li>
                    <a href="https://github.com/epunx2">
                        <i class="fa fa-github"></i>
                    </a>
                </li>
                <li>
                    <a href="tel:312-513-8086">
                        <i class="fa fa-phone"></i>
                    </a>
                </li>
                <li>
                    <a href="https://www.linkedin.com/in/echrobak">
                        <i class="fa fa-linkedin"></i>
                    </a>
                </li>
            </ul>
            <p class="copyright text-muted">&copy; Eric Chrobak 2015-2025</p>
        </div>
    </div>
</footer>

	<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.30.0/prism.min.js"></script> 
	<script src="https:///prismjs@v1.30.0/plugins/autoloader/prism-autoloader.min.js"></script>
</body>

</html>
